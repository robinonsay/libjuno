<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LibJuno: Juno Memory Module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
  <script type="text/javascript">
      DoxygenAwesomeDarkModeToggle.init()
  </script>
  <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
  <script type="text/javascript">
      DoxygenAwesomeFragmentCopyButton.init()
  </script>
  <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript">
      DoxygenAwesomeParagraphLink.init()
  </script>
  <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
  <script type="text/javascript">
      DoxygenAwesomeInteractiveToc.init()
  </script>
  <script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
  <script type="text/javascript">
      DoxygenAwesomeTabs.init()
  </script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-2K3RX3SR87"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-2K3RX3SR87');
  </script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="juno_logo_1.svg"/></td>
  <td id="projectalign">
   <div id="projectname">LibJuno<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">LibJuno is a lightweight C99 library designed specifically for embedded systems.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md__2home_2runner_2work_2libjuno_2libjuno_2include_2juno_2memory_2README.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Juno Memory Module</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a> Deterministic, static, block-based memory management for embedded systems. This module avoids dynamic allocation and favors predictable behavior and explicit error paths.</p>
<p>This document reflects the current APIs in <code><a class="el" href="memory__api_8h.html" title="Abstract memory allocation API and verification helpers.">juno/memory/memory_api.h</a></code>, <code><a class="el" href="pointer__api_8h.html" title="Pointer trait and helpers for memory operations.">juno/memory/pointer_api.h</a></code>, and <code><a class="el" href="memory__block_8h.html" title="Fixed-size block allocator interface and helpers.">juno/memory/memory_block.h</a></code> and matches the unit tests in <code>tests/test_memory.c</code>.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Overview</h1>
<p>The memory module provides a fixed-size block allocator. You supply:</p><ul>
<li>A statically allocated memory array for elements of a single type</li>
<li>A metadata array for the allocator's free list</li>
<li>A pointer API (Copy/Reset) that defines how to copy and reset one element</li>
</ul>
<p>The allocator exposes an API vtable with Get/Update/Put. Get returns a result containing both a status and a pointer payload.</p>
<p>The module integrates with LibJuno's module system:</p><ul>
<li><code>JUNO_POINTER_T</code> uses <code>JUNO_TRAIT_ROOT</code> to carry its API pointer</li>
<li><code>JUNO_MEMORY_ALLOC_ROOT_T</code> uses <code>JUNO_MODULE_ROOT</code> with both the allocator API and pointer API</li>
<li><code>JUNO_MEMORY_ALLOC_BLOCK_T</code> uses <code>JUNO_MODULE_DERIVE</code> to extend the root with implementation fields</li>
<li>Failure handlers can be attached to allocators for error reporting</li>
</ul>
<p>No reference counting is implemented in the current design.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Core types (public headers)</h1>
<h2><a class="anchor" id="autotoc_md3"></a>
&lt;tt&gt;JUNO_MEMORY_BLOCK_METADATA_T&lt;/tt&gt;</h2>
<p>Per-block metadata used by the allocator's free list. This is a simple public struct (currently contains a <code>uint8_t *ptFreeMem</code> field) used internally by the allocator. Treat it as allocator-managed storage: declare arrays with <code><a class="el" href="group__juno__memory__block.html#ga8942ee7462829b506969cd42e66d2ad7" title="Declare a static array for per-block metadata.">JUNO_MEMORY_BLOCK_METADATA(...)</a></code> but avoid reading/modifying fields directly. The layout may evolve; consumers should not rely on specific members.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
&lt;tt&gt;JUNO_POINTER_T&lt;/tt&gt;</h2>
<p>Describes a block of memory the allocator returned (defined in <code><a class="el" href="pointer__api_8h.html" title="Pointer trait and helpers for memory operations.">pointer_api.h</a></code>):</p><ul>
<li><code>void *pvAddr;</code> — block address</li>
<li><code>size_t zSize;</code> — block size in bytes</li>
<li><code>size_t zAlignment;</code> — required alignment for the block</li>
<li><code>const JUNO_POINTER_API_T *ptApi;</code> — pointer to the API (via <code>JUNO_TRAIT_ROOT</code> macro)</li>
</ul>
<h2><a class="anchor" id="autotoc_md5"></a>
&lt;tt&gt;JUNO_POINTER_API_T&lt;/tt&gt;</h2>
<p>Functions that the allocator calls per element type (defined in <code><a class="el" href="pointer__api_8h.html" title="Pointer trait and helpers for memory operations.">pointer_api.h</a></code>):</p><ul>
<li><code>JUNO_STATUS_T (*Copy)(JUNO_POINTER_T tDest, const JUNO_POINTER_T tSrc);</code> — copy from source to destination</li>
<li><code>JUNO_STATUS_T (*Reset)(JUNO_POINTER_T tPointer);</code> — reset/zero-initialize the memory</li>
</ul>
<h2><a class="anchor" id="autotoc_md6"></a>
&lt;tt&gt;JUNO_MEMORY_ALLOC_API_T&lt;/tt&gt;</h2>
<p>Allocator vtable:</p><ul>
<li><code>JUNO_RESULT_POINTER_T (*Get)(JUNO_MEMORY_ALLOC_ROOT_T *ptMem, size_t zSize);</code> — allocate a block</li>
<li><code>JUNO_STATUS_T (*Update)(JUNO_MEMORY_ALLOC_ROOT_T *ptMem, JUNO_POINTER_T *ptMemory, size_t zNewSize);</code> — update block size</li>
<li><code>JUNO_STATUS_T (*Put)(JUNO_MEMORY_ALLOC_ROOT_T *ptMem, JUNO_POINTER_T *ptMemory);</code> — free a block</li>
</ul>
<h2><a class="anchor" id="autotoc_md7"></a>
&lt;tt&gt;JUNO_MEMORY_ALLOC_ROOT_T&lt;/tt&gt; and &lt;tt&gt;JUNO_MEMORY_ALLOC_BLOCK_T&lt;/tt&gt;</h2>
<p>The concrete block allocator type is <code>JUNO_MEMORY_ALLOC_BLOCK_T</code> (derived via <code>JUNO_MODULE_DERIVE</code>). It contains:</p><ul>
<li><code>tRoot</code> member of type <code>JUNO_MEMORY_ALLOC_ROOT_T</code> carrying the API pointer and pointer API</li>
<li><code>pvMemory</code> — pointer to the allocated memory area (uint8_t*)</li>
<li><code>ptMetadata</code> — array of metadata for each block</li>
<li><code>zTypeSize</code> — size of each block element</li>
<li><code>zAlignment</code> — required alignment</li>
<li><code>zLength</code> — total number of blocks available</li>
<li><code>zUsed</code> — current count of allocated blocks (monotonically increases)</li>
<li><code>zFreed</code> — current count of freed blocks in the free stack</li>
</ul>
<h2><a class="anchor" id="autotoc_md8"></a>
&lt;tt&gt;JUNO_VALUE_POINTER_T&lt;/tt&gt; and &lt;tt&gt;JUNO_VALUE_POINTER_API_T&lt;/tt&gt;</h2>
<p>Extended pointer types with value semantics (defined in <code><a class="el" href="pointer__api_8h.html" title="Pointer trait and helpers for memory operations.">pointer_api.h</a></code>):</p><ul>
<li><code>JUNO_VALUE_POINTER_T</code> derives from <code>JUNO_POINTER_T</code></li>
<li><code>JUNO_VALUE_POINTER_API_T</code> adds <code>Equals</code> comparison operation</li>
</ul>
<h1><a class="anchor" id="autotoc_md9"></a>
Declaring memory and metadata</h1>
<p>Use the provided macros to declare storage:</p>
<div class="fragment"><div class="line"><span class="comment">// For C: initializes to {0}; for C++: {}</span></div>
<div class="line"><a class="code hl_define" href="group__juno__memory__block.html#gaf0d3dee078bfb9d9aeaf19018245ad9b">JUNO_MEMORY_BLOCK</a>(myBlock, MY_TYPE_T, 10);</div>
<div class="line"><a class="code hl_define" href="group__juno__memory__block.html#ga8942ee7462829b506969cd42e66d2ad7">JUNO_MEMORY_BLOCK_METADATA</a>(myMeta, 10);</div>
<div class="ttc" id="agroup__juno__memory__block_html_ga8942ee7462829b506969cd42e66d2ad7"><div class="ttname"><a href="group__juno__memory__block.html#ga8942ee7462829b506969cd42e66d2ad7">JUNO_MEMORY_BLOCK_METADATA</a></div><div class="ttdeci">#define JUNO_MEMORY_BLOCK_METADATA(name, length)</div><div class="ttdoc">Declare a static array for per-block metadata.</div><div class="ttdef"><b>Definition</b> memory_block.h:98</div></div>
<div class="ttc" id="agroup__juno__memory__block_html_gaf0d3dee078bfb9d9aeaf19018245ad9b"><div class="ttname"><a href="group__juno__memory__block.html#gaf0d3dee078bfb9d9aeaf19018245ad9b">JUNO_MEMORY_BLOCK</a></div><div class="ttdeci">#define JUNO_MEMORY_BLOCK(name, type, length)</div><div class="ttdoc">Declare a static contiguous memory array for block storage.</div><div class="ttdef"><b>Definition</b> memory_block.h:85</div></div>
</div><!-- fragment --><p>These create:</p><ul>
<li><code>static MY_TYPE_T myBlock[10];</code></li>
<li><code>static JUNO_MEMORY_BLOCK_METADATA_T myMeta[10];</code></li>
</ul>
<h1><a class="anchor" id="autotoc_md10"></a>
Pointer API (Copy and Reset)</h1>
<p>You must provide a <code>JUNO_POINTER_API_T</code> for your element type. For trivially copyable POD structs, Copy can assign and Reset can zero or reinitialize.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdalign.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="memory__api_8h.html">juno/memory/memory_api.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="pointer__api_8h.html">juno/memory/pointer_api.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    <span class="keywordtype">int</span> id;</div>
<div class="line">    <span class="keywordtype">bool</span> flag;</div>
<div class="line">} MY_TYPE_T;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Forward declare the API to use in checks</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_struct" href="structJUNO__POINTER__API__TAG.html">JUNO_POINTER_API_T</a> gMyPtrApi;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code hl_typedef" href="group__juno__status.html#ga37f8e6b135f0c1a21a3a34b19d1772aa">JUNO_STATUS_T</a> MyCopy(<a class="code hl_typedef" href="pointer__api_8h.html#a3caf7d5b9c47228dcbb289ab1f8a6045">JUNO_POINTER_T</a> tDest, <span class="keyword">const</span> <a class="code hl_typedef" href="pointer__api_8h.html#a3caf7d5b9c47228dcbb289ab1f8a6045">JUNO_POINTER_T</a> tSrc)</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_typedef" href="group__juno__status.html#ga37f8e6b135f0c1a21a3a34b19d1772aa">JUNO_STATUS_T</a> tStatus = <a class="code hl_define" href="group__juno__memory__pointer.html#ga4de2a95e1148dfe72629091792e84a6c">JunoMemory_PointerVerifyType</a>(tDest, MY_TYPE_T, gMyPtrApi);</div>
<div class="line">    <a class="code hl_define" href="group__juno__macros.html#gaef99be367bacf32d7c30b34e43a475b3">JUNO_ASSERT_SUCCESS</a>(tStatus, <span class="keywordflow">return</span> tStatus);</div>
<div class="line">    tStatus = <a class="code hl_define" href="group__juno__memory__pointer.html#ga4de2a95e1148dfe72629091792e84a6c">JunoMemory_PointerVerifyType</a>(tSrc, MY_TYPE_T, gMyPtrApi);</div>
<div class="line">    <a class="code hl_define" href="group__juno__macros.html#gaef99be367bacf32d7c30b34e43a475b3">JUNO_ASSERT_SUCCESS</a>(tStatus, <span class="keywordflow">return</span> tStatus);</div>
<div class="line">    *(MY_TYPE_T *)tDest.pvAddr = *(MY_TYPE_T *)tSrc.pvAddr;</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_define" href="group__juno__status__codes.html#gad89a3ea5be5fc21a4b97e2b1e761c084">JUNO_STATUS_SUCCESS</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code hl_typedef" href="group__juno__status.html#ga37f8e6b135f0c1a21a3a34b19d1772aa">JUNO_STATUS_T</a> MyReset(<a class="code hl_typedef" href="pointer__api_8h.html#a3caf7d5b9c47228dcbb289ab1f8a6045">JUNO_POINTER_T</a> tPointer)</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_typedef" href="group__juno__status.html#ga37f8e6b135f0c1a21a3a34b19d1772aa">JUNO_STATUS_T</a> tStatus = <a class="code hl_define" href="group__juno__memory__pointer.html#ga4de2a95e1148dfe72629091792e84a6c">JunoMemory_PointerVerifyType</a>(tPointer, MY_TYPE_T, gMyPtrApi);</div>
<div class="line">    <a class="code hl_define" href="group__juno__macros.html#gaef99be367bacf32d7c30b34e43a475b3">JUNO_ASSERT_SUCCESS</a>(tStatus, <span class="keywordflow">return</span> tStatus);</div>
<div class="line">    *(MY_TYPE_T *)tPointer.pvAddr = (MY_TYPE_T){0};</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_define" href="group__juno__status__codes.html#gad89a3ea5be5fc21a4b97e2b1e761c084">JUNO_STATUS_SUCCESS</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_struct" href="structJUNO__POINTER__API__TAG.html">JUNO_POINTER_API_T</a> gMyPtrApi = { MyCopy, MyReset };</div>
<div class="ttc" id="agroup__juno__macros_html_gaef99be367bacf32d7c30b34e43a475b3"><div class="ttname"><a href="group__juno__macros.html#gaef99be367bacf32d7c30b34e43a475b3">JUNO_ASSERT_SUCCESS</a></div><div class="ttdeci">#define JUNO_ASSERT_SUCCESS(tStatus,...)</div><div class="ttdoc">Execute the provided failure operation(s) if status is not success.</div><div class="ttdef"><b>Definition</b> macros.h:87</div></div>
<div class="ttc" id="agroup__juno__memory__pointer_html_ga4de2a95e1148dfe72629091792e84a6c"><div class="ttname"><a href="group__juno__memory__pointer.html#ga4de2a95e1148dfe72629091792e84a6c">JunoMemory_PointerVerifyType</a></div><div class="ttdeci">#define JunoMemory_PointerVerifyType(pointer, type, tApi)</div><div class="ttdoc">Verify pointer descriptor matches an expected type and API.</div><div class="ttdef"><b>Definition</b> pointer_api.h:128</div></div>
<div class="ttc" id="agroup__juno__status__codes_html_gad89a3ea5be5fc21a4b97e2b1e761c084"><div class="ttname"><a href="group__juno__status__codes.html#gad89a3ea5be5fc21a4b97e2b1e761c084">JUNO_STATUS_SUCCESS</a></div><div class="ttdeci">#define JUNO_STATUS_SUCCESS</div><div class="ttdoc">Operation completed successfully.</div><div class="ttdef"><b>Definition</b> status.h:56</div></div>
<div class="ttc" id="agroup__juno__status_html_ga37f8e6b135f0c1a21a3a34b19d1772aa"><div class="ttname"><a href="group__juno__status.html#ga37f8e6b135f0c1a21a3a34b19d1772aa">JUNO_STATUS_T</a></div><div class="ttdeci">int32_t JUNO_STATUS_T</div><div class="ttdoc">Canonical status type for LibJuno functions.</div><div class="ttdef"><b>Definition</b> status.h:49</div></div>
<div class="ttc" id="amemory__api_8h_html"><div class="ttname"><a href="memory__api_8h.html">memory_api.h</a></div><div class="ttdoc">Abstract memory allocation API and verification helpers.</div></div>
<div class="ttc" id="apointer__api_8h_html"><div class="ttname"><a href="pointer__api_8h.html">pointer_api.h</a></div><div class="ttdoc">Pointer trait and helpers for memory operations.</div></div>
<div class="ttc" id="apointer__api_8h_html_a3caf7d5b9c47228dcbb289ab1f8a6045"><div class="ttname"><a href="pointer__api_8h.html#a3caf7d5b9c47228dcbb289ab1f8a6045">JUNO_POINTER_T</a></div><div class="ttdeci">struct JUNO_POINTER_TAG JUNO_POINTER_T</div><div class="ttdef"><b>Definition</b> pointer_api.h:49</div></div>
<div class="ttc" id="astructJUNO__POINTER__API__TAG_html"><div class="ttname"><a href="structJUNO__POINTER__API__TAG.html">JUNO_POINTER_API_TAG</a></div><div class="ttdoc">Pointer operations API (copy/reset).</div><div class="ttdef"><b>Definition</b> pointer_api.h:74</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md11"></a>
Helpers provided by the API</h2>
<ul>
<li><code><a class="el" href="group__juno__memory__pointer.html#ga4de2a95e1148dfe72629091792e84a6c" title="Verify pointer descriptor matches an expected type and API.">JunoMemory_PointerVerifyType(pointer, TYPE, tApi)</a></code> — validates size, alignment, and API matching</li>
<li><code><a class="el" href="group__juno__memory__pointer.html#ga68473ae83b6c7edc9d3d5548a0e30771" title="Initialize a JUNO_POINTER_T with API, type, and address.">JunoMemory_PointerInit(api, TYPE, addr)</a></code> — constructs a typed pointer descriptor (rarely needed by users)</li>
<li><code>JUNO_ASSERT_POINTER_COPY(tDest, tSrc, tApi)</code> — validates preconditions for copy operations</li>
<li><code>JunoMemory_PointerApiVerify(ptPointerApi)</code> — verifies a pointer API vtable is complete</li>
<li><code>JunoMemory_PointerVerify(tPointer)</code> — verifies a pointer structure is valid</li>
<li><code>JunoMemory_AllocApiVerify(ptAllocApi)</code> — verifies an allocator API vtable is complete</li>
<li><code>JunoMemory_AllocVerify(ptAlloc)</code> — verifies an allocator root structure is valid</li>
</ul>
<h1><a class="anchor" id="autotoc_md12"></a>
Initializing the block allocator</h1>
<p>Signature (from <code><a class="el" href="memory__block_8h.html" title="Fixed-size block allocator interface and helpers.">memory_block.h</a></code>):</p>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="group__juno__status.html#ga37f8e6b135f0c1a21a3a34b19d1772aa">JUNO_STATUS_T</a> <a class="code hl_function" href="group__juno__memory__block.html#gaf5cb070171a69cefe8c86b2275e6db0b">JunoMemory_BlockInit</a>(</div>
<div class="line">    <a class="code hl_typedef" href="memory__block_8h.html#aedb8dcf65a30cfeb601803caf159ae03">JUNO_MEMORY_ALLOC_BLOCK_T</a> *ptJunoMemoryBlock,</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_struct" href="structJUNO__POINTER__API__TAG.html">JUNO_POINTER_API_T</a> *ptPointerApi,</div>
<div class="line">    <span class="keywordtype">void</span> *pvMemory,</div>
<div class="line">    <a class="code hl_struct" href="structJUNO__MEMORY__BLOCK__METADATA__TAG.html">JUNO_MEMORY_BLOCK_METADATA_T</a> *ptMetadata,</div>
<div class="line">    <span class="keywordtype">size_t</span> zTypeSize,</div>
<div class="line">    <span class="keywordtype">size_t</span> zAlignment,</div>
<div class="line">    <span class="keywordtype">size_t</span> zLength,</div>
<div class="line">    <a class="code hl_typedef" href="group__juno__status.html#ga0fbff8c7db15c2f4d01e82b8a863dbbc">JUNO_FAILURE_HANDLER_T</a> pfcnFailureHandler,</div>
<div class="line">    <a class="code hl_typedef" href="group__juno__status.html#gaf575dc984c80091757afe42a5d5c2b60">JUNO_USER_DATA_T</a> *pvFailureUserData</div>
<div class="line">);</div>
<div class="ttc" id="agroup__juno__memory__block_html_gaf5cb070171a69cefe8c86b2275e6db0b"><div class="ttname"><a href="group__juno__memory__block.html#gaf5cb070171a69cefe8c86b2275e6db0b">JunoMemory_BlockInit</a></div><div class="ttdeci">JUNO_STATUS_T JunoMemory_BlockInit(JUNO_MEMORY_ALLOC_BLOCK_T *ptJunoMemory, const JUNO_POINTER_API_T *ptPointerApi, void *pvMemory, JUNO_MEMORY_BLOCK_METADATA_T *ptMetadata, size_t zTypeSize, size_t zAlignment, size_t zLength, JUNO_FAILURE_HANDLER_T pfcnFailureHandler, JUNO_USER_DATA_T *pvFailureUserData)</div><div class="ttdoc">Initialize a fixed-size block allocator over a caller-supplied region.</div><div class="ttdef"><b>Definition</b> juno_memory_block.c:245</div></div>
<div class="ttc" id="agroup__juno__status_html_ga0fbff8c7db15c2f4d01e82b8a863dbbc"><div class="ttname"><a href="group__juno__status.html#ga0fbff8c7db15c2f4d01e82b8a863dbbc">JUNO_FAILURE_HANDLER_T</a></div><div class="ttdeci">void(* JUNO_FAILURE_HANDLER_T)(JUNO_STATUS_T tStatus, const char *pcCustomMessage, JUNO_USER_DATA_T *pvUserData)</div><div class="ttdoc">Failure handler callback signature.</div><div class="ttdef"><b>Definition</b> status.h:104</div></div>
<div class="ttc" id="agroup__juno__status_html_gaf575dc984c80091757afe42a5d5c2b60"><div class="ttname"><a href="group__juno__status.html#gaf575dc984c80091757afe42a5d5c2b60">JUNO_USER_DATA_T</a></div><div class="ttdeci">void JUNO_USER_DATA_T</div><div class="ttdoc">Opaque user data type for failure callbacks.</div><div class="ttdef"><b>Definition</b> status.h:96</div></div>
<div class="ttc" id="amemory__block_8h_html_aedb8dcf65a30cfeb601803caf159ae03"><div class="ttname"><a href="memory__block_8h.html#aedb8dcf65a30cfeb601803caf159ae03">JUNO_MEMORY_ALLOC_BLOCK_T</a></div><div class="ttdeci">struct JUNO_MEMORY_ALLOC_BLOCK_TAG JUNO_MEMORY_ALLOC_BLOCK_T</div><div class="ttdef"><b>Definition</b> memory_block.h:103</div></div>
<div class="ttc" id="astructJUNO__MEMORY__BLOCK__METADATA__TAG_html"><div class="ttname"><a href="structJUNO__MEMORY__BLOCK__METADATA__TAG.html">JUNO_MEMORY_BLOCK_METADATA_TAG</a></div><div class="ttdoc">Metadata for a memory block entry (allocator-specific).</div><div class="ttdef"><b>Definition</b> memory_block.h:112</div></div>
</div><!-- fragment --><p>Usage:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="memory__block_8h.html">juno/memory/memory_block.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="memory__block_8h.html#aedb8dcf65a30cfeb601803caf159ae03">JUNO_MEMORY_ALLOC_BLOCK_T</a> tMem = {0};</div>
<div class="line"><a class="code hl_typedef" href="group__juno__status.html#ga37f8e6b135f0c1a21a3a34b19d1772aa">JUNO_STATUS_T</a> tStatus = <a class="code hl_function" href="group__juno__memory__block.html#gaf5cb070171a69cefe8c86b2275e6db0b">JunoMemory_BlockInit</a>(</div>
<div class="line">    &amp;tMem,</div>
<div class="line">    &amp;gMyPtrApi,</div>
<div class="line">    myBlock,</div>
<div class="line">    myMeta,</div>
<div class="line">    <span class="keyword">sizeof</span>(MY_TYPE_T),</div>
<div class="line">    <span class="keyword">alignof</span>(MY_TYPE_T),</div>
<div class="line">    10,</div>
<div class="line">    <span class="comment">/* failure handler */</span> NULL,</div>
<div class="line">    <span class="comment">/* user data */</span> NULL</div>
<div class="line">);</div>
<div class="line"><span class="keywordflow">if</span> (tStatus != <a class="code hl_define" href="group__juno__status__codes.html#gad89a3ea5be5fc21a4b97e2b1e761c084">JUNO_STATUS_SUCCESS</a>) { <span class="comment">/* handle error */</span> }</div>
<div class="ttc" id="amemory__block_8h_html"><div class="ttname"><a href="memory__block_8h.html">memory_block.h</a></div><div class="ttdoc">Fixed-size block allocator interface and helpers.</div></div>
</div><!-- fragment --><p>Notes:</p><ul>
<li><code>ptPointerApi</code> and <code>zAlignment</code> are required and validated.</li>
<li><code>pvMemory</code> must be aligned to <code>zAlignment</code>.</li>
<li>Failure handler and user data are optional.</li>
<li>The function validates parameters and sets up the allocator's internal state.</li>
</ul>
<h1><a class="anchor" id="autotoc_md13"></a>
Allocating, updating, and freeing</h1>
<p>Obtain the allocator API via the root member (<code>tRoot</code>), then call through it. Get returns a result struct; check <code>tStatus</code> before using <code>tOk</code>.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <a class="code hl_struct" href="structJUNO__MEMORY__ALLOC__API__TAG.html">JUNO_MEMORY_ALLOC_API_T</a> *ptApi = tMem.tRoot.ptApi;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Allocate</span></div>
<div class="line">JUNO_RESULT_POINTER_T r = ptApi-&gt;<a class="code hl_variable" href="structJUNO__MEMORY__ALLOC__API__TAG.html#ad3c6cfeddd4c3a1605db44e474ee21a6">Get</a>(&amp;tMem.tRoot, <span class="keyword">sizeof</span>(MY_TYPE_T));</div>
<div class="line"><span class="keywordflow">if</span> (r.tStatus != <a class="code hl_define" href="group__juno__status__codes.html#gad89a3ea5be5fc21a4b97e2b1e761c084">JUNO_STATUS_SUCCESS</a>) { <span class="comment">/* handle full/invalid size */</span> }</div>
<div class="line"><a class="code hl_typedef" href="pointer__api_8h.html#a3caf7d5b9c47228dcbb289ab1f8a6045">JUNO_POINTER_T</a> tPtr = r.tOk;</div>
<div class="line">MY_TYPE_T *p = (MY_TYPE_T *)tPtr.pvAddr;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// The returned pointer includes:</span></div>
<div class="line"><span class="comment">//   - tPtr.pvAddr: address of the allocated block</span></div>
<div class="line"><span class="comment">//   - tPtr.zSize: size set to zTypeSize from the allocator</span></div>
<div class="line"><span class="comment">//   - tPtr.zAlignment: alignment from the allocator</span></div>
<div class="line"><span class="comment">//   - tPtr.ptApi: pointer to the API used for Copy/Reset</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Update size (must not exceed element size)</span></div>
<div class="line"><a class="code hl_typedef" href="group__juno__status.html#ga37f8e6b135f0c1a21a3a34b19d1772aa">JUNO_STATUS_T</a> st = ptApi-&gt;<a class="code hl_variable" href="structJUNO__MEMORY__ALLOC__API__TAG.html#a5dc3ffdbd030201705382188e67d9e84">Update</a>(&amp;tMem.tRoot, &amp;tPtr, <span class="keyword">sizeof</span>(MY_TYPE_T));</div>
<div class="line"><span class="keywordflow">if</span> (st != <a class="code hl_define" href="group__juno__status__codes.html#gad89a3ea5be5fc21a4b97e2b1e761c084">JUNO_STATUS_SUCCESS</a>) { <span class="comment">/* handle size too large */</span> }</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Free (pointer is cleared on success)</span></div>
<div class="line">st = ptApi-&gt;<a class="code hl_variable" href="structJUNO__MEMORY__ALLOC__API__TAG.html#a2b19393bfb6a437862b85ad8951406f0">Put</a>(&amp;tMem.tRoot, &amp;tPtr);</div>
<div class="line"><span class="keywordflow">if</span> (st == <a class="code hl_define" href="group__juno__status__codes.html#gad89a3ea5be5fc21a4b97e2b1e761c084">JUNO_STATUS_SUCCESS</a>) {</div>
<div class="line">    <span class="comment">// tPtr.pvAddr is now NULL, zSize and zAlignment are zeroed</span></div>
<div class="line">}</div>
<div class="ttc" id="astructJUNO__MEMORY__ALLOC__API__TAG_html"><div class="ttname"><a href="structJUNO__MEMORY__ALLOC__API__TAG.html">JUNO_MEMORY_ALLOC_API_TAG</a></div><div class="ttdoc">Vtable for memory allocation operations.</div><div class="ttdef"><b>Definition</b> memory_api.h:80</div></div>
<div class="ttc" id="astructJUNO__MEMORY__ALLOC__API__TAG_html_a2b19393bfb6a437862b85ad8951406f0"><div class="ttname"><a href="structJUNO__MEMORY__ALLOC__API__TAG.html#a2b19393bfb6a437862b85ad8951406f0">JUNO_MEMORY_ALLOC_API_TAG::Put</a></div><div class="ttdeci">JUNO_STATUS_T(* Put)(JUNO_MEMORY_ALLOC_ROOT_T *ptMem, JUNO_POINTER_T *pvAddr)</div><div class="ttdoc">Free a previously allocated memory region.</div><div class="ttdef"><b>Definition</b> memory_api.h:98</div></div>
<div class="ttc" id="astructJUNO__MEMORY__ALLOC__API__TAG_html_a5dc3ffdbd030201705382188e67d9e84"><div class="ttname"><a href="structJUNO__MEMORY__ALLOC__API__TAG.html#a5dc3ffdbd030201705382188e67d9e84">JUNO_MEMORY_ALLOC_API_TAG::Update</a></div><div class="ttdeci">JUNO_STATUS_T(* Update)(JUNO_MEMORY_ALLOC_ROOT_T *ptMem, JUNO_POINTER_T *ptMemory, size_t zNewSize)</div><div class="ttdoc">Update an existing allocation to a new size (in-place descriptor update).</div><div class="ttdef"><b>Definition</b> memory_api.h:92</div></div>
<div class="ttc" id="astructJUNO__MEMORY__ALLOC__API__TAG_html_ad3c6cfeddd4c3a1605db44e474ee21a6"><div class="ttname"><a href="structJUNO__MEMORY__ALLOC__API__TAG.html#ad3c6cfeddd4c3a1605db44e474ee21a6">JUNO_MEMORY_ALLOC_API_TAG::Get</a></div><div class="ttdeci">JUNO_RESULT_POINTER_T(* Get)(JUNO_MEMORY_ALLOC_ROOT_T *ptMem, size_t zSize)</div><div class="ttdoc">Allocate a memory region of at least zSize bytes.</div><div class="ttdef"><b>Definition</b> memory_api.h:85</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md14"></a>
Typed convenience macros</h2>
<p><code><a class="el" href="memory__block_8h.html" title="Fixed-size block allocator interface and helpers.">memory_block.h</a></code> provides small wrappers:</p>
<div class="fragment"><div class="line"><span class="comment">// Get a block for a type; returns JUNO_RESULT_POINTER_T</span></div>
<div class="line">JUNO_RESULT_POINTER_T r = <a class="code hl_define" href="group__juno__memory__block.html#ga6d2be7363a8cfb54e0326a9fae49e22f">JunoMemory_BlockGetT</a>(&amp;tMem, MY_TYPE_T);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Put a previously acquired JUNO_POINTER_T*</span></div>
<div class="line"><a class="code hl_typedef" href="group__juno__status.html#ga37f8e6b135f0c1a21a3a34b19d1772aa">JUNO_STATUS_T</a> st = <a class="code hl_define" href="group__juno__memory__block.html#ga3cfb92b8ba4e654dedc6fed0adb898bf">JunoMemory_BlockPutT</a>(&amp;tMem, &amp;tPtr);</div>
<div class="ttc" id="agroup__juno__memory__block_html_ga3cfb92b8ba4e654dedc6fed0adb898bf"><div class="ttname"><a href="group__juno__memory__block.html#ga3cfb92b8ba4e654dedc6fed0adb898bf">JunoMemory_BlockPutT</a></div><div class="ttdeci">#define JunoMemory_BlockPutT(ptBlkRoot, pPtr)</div><div class="ttdoc">Free a previously allocated block given its pointer descriptor.</div><div class="ttdef"><b>Definition</b> memory_block.h:178</div></div>
<div class="ttc" id="agroup__juno__memory__block_html_ga6d2be7363a8cfb54e0326a9fae49e22f"><div class="ttname"><a href="group__juno__memory__block.html#ga6d2be7363a8cfb54e0326a9fae49e22f">JunoMemory_BlockGetT</a></div><div class="ttdeci">#define JunoMemory_BlockGetT(ptBlkRoot, type)</div><div class="ttdoc">Allocate a block sized for the specified C type.</div><div class="ttdef"><b>Definition</b> memory_block.h:170</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md15"></a>
Internal allocator behavior</h1>
<p>The block allocator maintains:</p><ul>
<li><code>zUsed</code>: Total number of blocks ever allocated (monotonically increases until pool is full)</li>
<li><code>zFreed</code>: Count of freed blocks available for reuse (decreases on Get, increases on Put)</li>
<li>Freed blocks are tracked in the <code>ptMetadata</code> array as a stack (LIFO order)</li>
</ul>
<p>Allocation strategy:</p><ol type="1">
<li>If freed blocks exist (<code>zFreed &gt; 0</code>), reuse the most recently freed block</li>
<li>Otherwise, if room remains (<code>zUsed &lt; zLength</code>), allocate a new block from the pool</li>
<li>When all blocks are allocated and none are freed, return <code>JUNO_STATUS_MEMALLOC_ERROR</code></li>
</ol>
<p>The allocator automatically calls <code>Reset</code> on newly allocated blocks. If <code>Reset</code> fails, the block is returned to the free list and the error is propagated.</p>
<h1><a class="anchor" id="autotoc_md16"></a>
Common pitfalls</h1>
<ul>
<li>Always check <code>tStatus</code> on results from <code>Get</code>; don't use <code>tOk</code> unless success.</li>
<li>Request sizes must be &gt; 0 and &lt;= element size (<code>zTypeSize</code>).</li>
<li>Freeing the same pointer twice is rejected with <code>JUNO_STATUS_MEMFREE_ERROR</code>.</li>
<li>Passing an address outside the managed block range is rejected.</li>
<li>Passing an unaligned address to <code>Put</code> is rejected.</li>
<li>Ensure <code>pvMemory</code> is correctly aligned; pass <code>alignof(TYPE)</code> at init.</li>
<li>After a successful <code>Put</code>, the pointer's <code>pvAddr</code> is set to NULL, <code>zSize</code> and <code>zAlignment</code> are zeroed.</li>
<li>The <code>JunoMemory_PointerVerifyType</code> macro now requires three arguments: <code>(pointer, TYPE, tApi)</code>.</li>
<li>The <code>Copy</code> function signature takes <code>const JUNO_POINTER_T tSrc</code> (const second parameter).</li>
<li>When the <code>Reset</code> operation fails during <code>Get</code>, the block is returned to the free list automatically.</li>
</ul>
<h1><a class="anchor" id="autotoc_md17"></a>
Minimal end-to-end example (compiles like the tests)</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdalign.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdbool.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="memory__api_8h.html">juno/memory/memory_api.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="memory__block_8h.html">juno/memory/memory_block.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="pointer__api_8h.html">juno/memory/pointer_api.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{ <span class="keywordtype">int</span> id; <span class="keywordtype">bool</span> flag; } MY_TYPE_T;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_define" href="group__juno__memory__block.html#gaf0d3dee078bfb9d9aeaf19018245ad9b">JUNO_MEMORY_BLOCK</a>(gMem, MY_TYPE_T, 10);</div>
<div class="line"><a class="code hl_define" href="group__juno__memory__block.html#ga8942ee7462829b506969cd42e66d2ad7">JUNO_MEMORY_BLOCK_METADATA</a>(gMeta, 10);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Forward declare the API to use in checks</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_struct" href="structJUNO__POINTER__API__TAG.html">JUNO_POINTER_API_T</a> gPtrApi;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code hl_typedef" href="group__juno__status.html#ga37f8e6b135f0c1a21a3a34b19d1772aa">JUNO_STATUS_T</a> Copy(<a class="code hl_typedef" href="pointer__api_8h.html#a3caf7d5b9c47228dcbb289ab1f8a6045">JUNO_POINTER_T</a> d, <span class="keyword">const</span> <a class="code hl_typedef" href="pointer__api_8h.html#a3caf7d5b9c47228dcbb289ab1f8a6045">JUNO_POINTER_T</a> s) {</div>
<div class="line">    <a class="code hl_typedef" href="group__juno__status.html#ga37f8e6b135f0c1a21a3a34b19d1772aa">JUNO_STATUS_T</a> st = <a class="code hl_define" href="group__juno__memory__pointer.html#ga4de2a95e1148dfe72629091792e84a6c">JunoMemory_PointerVerifyType</a>(d, MY_TYPE_T, gPtrApi);</div>
<div class="line">    <a class="code hl_define" href="group__juno__macros.html#gaef99be367bacf32d7c30b34e43a475b3">JUNO_ASSERT_SUCCESS</a>(st, <span class="keywordflow">return</span> st);</div>
<div class="line">    st = <a class="code hl_define" href="group__juno__memory__pointer.html#ga4de2a95e1148dfe72629091792e84a6c">JunoMemory_PointerVerifyType</a>(s, MY_TYPE_T, gPtrApi);</div>
<div class="line">    <a class="code hl_define" href="group__juno__macros.html#gaef99be367bacf32d7c30b34e43a475b3">JUNO_ASSERT_SUCCESS</a>(st, <span class="keywordflow">return</span> st);</div>
<div class="line">    *(MY_TYPE_T*)d.pvAddr = *(MY_TYPE_T*)s.pvAddr; </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_define" href="group__juno__status__codes.html#gad89a3ea5be5fc21a4b97e2b1e761c084">JUNO_STATUS_SUCCESS</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code hl_typedef" href="group__juno__status.html#ga37f8e6b135f0c1a21a3a34b19d1772aa">JUNO_STATUS_T</a> Reset(<a class="code hl_typedef" href="pointer__api_8h.html#a3caf7d5b9c47228dcbb289ab1f8a6045">JUNO_POINTER_T</a> p) {</div>
<div class="line">    <a class="code hl_typedef" href="group__juno__status.html#ga37f8e6b135f0c1a21a3a34b19d1772aa">JUNO_STATUS_T</a> st = <a class="code hl_define" href="group__juno__memory__pointer.html#ga4de2a95e1148dfe72629091792e84a6c">JunoMemory_PointerVerifyType</a>(p, MY_TYPE_T, gPtrApi);</div>
<div class="line">    <a class="code hl_define" href="group__juno__macros.html#gaef99be367bacf32d7c30b34e43a475b3">JUNO_ASSERT_SUCCESS</a>(st, <span class="keywordflow">return</span> st);</div>
<div class="line">    *(MY_TYPE_T*)p.pvAddr = (MY_TYPE_T){0}; </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_define" href="group__juno__status__codes.html#gad89a3ea5be5fc21a4b97e2b1e761c084">JUNO_STATUS_SUCCESS</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_struct" href="structJUNO__POINTER__API__TAG.html">JUNO_POINTER_API_T</a> gPtrApi = { Copy, Reset };</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> example(<span class="keywordtype">void</span>) {</div>
<div class="line">    <a class="code hl_typedef" href="memory__block_8h.html#aedb8dcf65a30cfeb601803caf159ae03">JUNO_MEMORY_ALLOC_BLOCK_T</a> mem = {0};</div>
<div class="line">    <a class="code hl_typedef" href="group__juno__status.html#ga37f8e6b135f0c1a21a3a34b19d1772aa">JUNO_STATUS_T</a> st = <a class="code hl_function" href="group__juno__memory__block.html#gaf5cb070171a69cefe8c86b2275e6db0b">JunoMemory_BlockInit</a>(&amp;mem, &amp;gPtrApi, gMem, gMeta,</div>
<div class="line">                                            <span class="keyword">sizeof</span>(MY_TYPE_T), <span class="keyword">alignof</span>(MY_TYPE_T), 10,</div>
<div class="line">                                            NULL, NULL);</div>
<div class="line">    <span class="keywordflow">if</span> (st != <a class="code hl_define" href="group__juno__status__codes.html#gad89a3ea5be5fc21a4b97e2b1e761c084">JUNO_STATUS_SUCCESS</a>) <span class="keywordflow">return</span>;</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_struct" href="structJUNO__MEMORY__ALLOC__API__TAG.html">JUNO_MEMORY_ALLOC_API_T</a> *api = mem.tRoot.ptApi;</div>
<div class="line"> </div>
<div class="line">    JUNO_RESULT_POINTER_T r = api-&gt;<a class="code hl_variable" href="structJUNO__MEMORY__ALLOC__API__TAG.html#ad3c6cfeddd4c3a1605db44e474ee21a6">Get</a>(&amp;mem.tRoot, <span class="keyword">sizeof</span>(MY_TYPE_T));</div>
<div class="line">    <span class="keywordflow">if</span> (r.tStatus != <a class="code hl_define" href="group__juno__status__codes.html#gad89a3ea5be5fc21a4b97e2b1e761c084">JUNO_STATUS_SUCCESS</a>) <span class="keywordflow">return</span>;</div>
<div class="line">    <a class="code hl_typedef" href="pointer__api_8h.html#a3caf7d5b9c47228dcbb289ab1f8a6045">JUNO_POINTER_T</a> ptr = r.tOk;</div>
<div class="line">    ((MY_TYPE_T*)ptr.pvAddr)-&gt;id = 42;</div>
<div class="line">    (void)api-&gt;<a class="code hl_variable" href="structJUNO__MEMORY__ALLOC__API__TAG.html#a2b19393bfb6a437862b85ad8951406f0">Put</a>(&amp;mem.tRoot, &amp;ptr);</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md18"></a>
Freestanding notes</h1>
<p>The module is suitable for freestanding builds. Avoid hosted headers in your Copy/Reset implementations; prefer simple assignment/zeroing for POD types. In freestanding mode, enable the CMake option <code>-DJUNO_FREESTANDING=ON</code> and ensure your <code>pvMemory</code> buffer is properly aligned for the element type.</p>
<h1><a class="anchor" id="autotoc_md19"></a>
Error Handling</h1>
<p>The memory module reports errors through status codes of type <code>JUNO_STATUS_T</code>:</p>
<ul>
<li><code>JUNO_STATUS_SUCCESS</code>: Operation completed successfully</li>
<li><code>JUNO_STATUS_MEMALLOC_ERROR</code>: Failed to allocate memory (block is full or size exceeds element size)</li>
<li><code>JUNO_STATUS_MEMFREE_ERROR</code>: Failed to free memory (invalid address, double free, or unaligned address)</li>
<li><code>JUNO_STATUS_NULLPTR_ERROR</code>: Null pointer provided to function (handled by <code>JUNO_ASSERT_EXISTS</code>)</li>
<li><code>JUNO_STATUS_INVALID_TYPE_ERROR</code>: Invalid memory allocator type (API mismatch)</li>
<li><code>JUNO_STATUS_INVALID_SIZE_ERROR</code>: Invalid size parameter (e.g., zero size)</li>
<li><code>JUNO_STATUS_ERR</code>: General error (e.g., corrupt allocator counters, alignment issues, overflow)</li>
</ul>
<h1><a class="anchor" id="autotoc_md20"></a>
Best Practices</h1>
<ol type="1">
<li><b>Always check status codes</b>: Memory operations can fail, especially in resource-constrained environments.</li>
<li><b>Define appropriate block sizes</b>: Size your memory blocks based on your application's needs to avoid waste.</li>
<li><b>Implement failure handlers</b>: Use failure handlers to catch memory issues early during development.</li>
<li><b>Initialize your data</b>: Even if memory is zeroed by Reset, initialize your data structures explicitly to reveal intent.</li>
<li><b>Use typed macros</b>: Prefer <code>JunoMemory_BlockGetT</code> and <code>JunoMemory_BlockPutT</code> to reduce size mismatches.</li>
<li><b>Forward declare APIs</b>: When using <code>JunoMemory_PointerVerifyType</code> in Copy/Reset, forward declare the API constant.</li>
</ol>
<h1><a class="anchor" id="autotoc_md21"></a>
Future work</h1>
<p>Reference counting is planned but not implemented in the current allocator. The macros <code>JUNO_REF</code> and <code>JUNO_NEW_REF</code> are reserved for a future reference-counting extension and should not be used yet. Status codes such as <code>JUNO_STATUS_INVALID_REF_ERROR</code> and <code>JUNO_STATUS_REF_IN_USE_ERROR</code> are defined globally but are not produced by the block allocator at this time. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
